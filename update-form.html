<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ultra Wash â€” Worker Update Form</title>
  <link rel="stylesheet" href="assets/style.css" />
</head>

<body>
<div class="layout">

  <!-- ======================== SIDEBAR ======================== -->
  <div class="sidebar">
    <div class="brand">Ultra Wash</div>
    <nav>
      <a href="index.html">ğŸ  Dashboard</a>
      <a href="customer-form.html">ğŸ“ Customer Form</a>
      <a href="update-form.html" class="active">ğŸ”§ Worker Update Form</a>
    </nav>
  </div>

  <!-- ======================== MAIN ========================== -->
  <div class="main">

    <!-- ======================== TOPBAR ======================== -->
    <div class="topbar">
      <div class="title">Worker Update Form</div>
      <div class="right">
        <div class="toggle-darkmode"><div class="circle"></div></div>
      </div>
    </div>

    <!-- ======================== CONTENT ======================= -->
    <div class="content">

      <div class="card">
        <h2>Customer Order Update</h2>
        <p>Select a customer to auto-fill their details and update the order.</p>
      </div>

      <!-- ================= FORM CARD ================= -->
      <div class="card">
        <form id="updateFormPage">

          <!-- ================= SECTION: SEARCH CUSTOMER ================= -->
          <div class="section-title">ğŸ” Search Customer</div>

          <label>Customer</label>
          <input 
            type="text"
            id="customerRefSearch"
            placeholder="Search customer name or ID..."
            autocomplete="off"
          />

          <!-- Dropdown results list -->
          <div id="customerSearchList"
               style="border:1px solid var(--border); padding:10px; margin-top:5px; 
                      border-radius:var(--radius); max-height:220px; overflow:auto; display:none;">
          </div>

          <!-- Hidden customer ID -->
          <input type="hidden" id="customerRef" name="customerRef" />

          <hr style="margin:25px 0;" />

          <!-- ================= SECTION: AUTO-FILLED INFO ================= -->
          <div class="section-title">ğŸ“„ Customer Details</div>

          <label>Customer Name</label>
          <input type="text" id="customerNameWorker" readonly />

          <label>Phone Number</label>
          <input type="text" id="customerPhoneWorker" name="customerPhoneWorker" readonly />

          <label>Service Type</label>
          <input type="text" id="serviceWorker" readonly />

          <label>Map Link</label>
          <input type="text" id="mapLinkWorker" name="mapLinkWorker" readonly />

          <!-- Backend address for worker -->
          <input type="hidden" id="backendAddress" name="backendAddress" />

          <hr style="margin:25px 0;" />

          <!-- ================= SECTION: PACKAGE INFO ================= -->
          <div class="section-title">ğŸ“¦ Package Details</div>

          <label>Package Type</label>
          <input type="text" id="pricingServiceUpdateDisplay" readonly />
          <input type="hidden" id="pricingServiceUpdate" name="pricingServiceUpdate" />

          <!-- ===== Membership Update ===== -->
          <div id="membershipFieldsUpdate" class="hidden">
            <label>Membership Plan</label>
            <select id="membershipPlanUpdate" name="membershipPlanUpdate" disabled>
              <option value="">Select Plan</option>
              <option value="120-12-60">$120 â€“ 12 trips (60kg)</option>
              <option value="100-2-50">$100 â€“ 2x/week (50kg)</option>
            </select>

            <div class="card" style="margin-top:15px;">
              <h3>Membership Usage</h3>

              <label>Trips Used</label>
              <input type="number" id="tripsUsed" name="tripsUsed" value="1" min="1" />

              <label>Weight Used (Kg)</label>
              <input type="number" id="weightUsed" name="weightUsed" min="0" step="0.1" />

              <div class="card" style="margin-top:15px;">
                <strong>Remaining Balance</strong>
                <p id="tripsBalance">Trips Remaining: --</p>
                <p id="weightBalance">Weight Remaining: -- kg</p>
              </div>
            </div>
          </div>

          <!-- ===== Jimat Update ===== -->
          <div id="jimatFieldsUpdate" class="hidden">
            <label>Jimat Box</label>
            <select id="jimatPlanUpdate" name="jimatPlanUpdate" disabled>
              <option value="">Select Box</option>
              <option value="16">$16 / 1 box</option>
              <option value="28">$28 / 2 boxes</option>
              <option value="40">$40 / 4 boxes</option>
            </select>
          </div>

          <!-- ===== Wash Update ===== -->
          <div id="washFieldsUpdate" class="hidden">
            <label>Weight (kg)</label>
            <input type="number" id="washKgUpdate" name="washKgUpdate" min="1" step="1" />
          </div>

          <!-- ===== Folding Update ===== -->
          <div id="foldingFieldsUpdate" class="hidden">
            <label>Weight (kg)</label>
            <input type="number" id="foldKgUpdate" name="foldKgUpdate" min="1" step="1" />
          </div>

          <!-- ===== Ironing Update ===== -->
          <div id="ironingFieldsUpdate" class="hidden">
            <label>Number of Pieces</label>
            <input type="number" id="ironPcsUpdate" name="ironPcsUpdate" min="1" step="1" />
          </div>

          <hr style="margin:25px 0;" />

          <!-- ================= SECTION: PRICE ================= -->
          <div id="pricingContainer" class="card" style="background:var(--bg); border:1px dashed var(--border);">
            <h3>Total Price</h3>
            <p><strong id="totalPriceUpdate">--</strong></p>
            <p id="priceBreakdownUpdate">--</p>
          </div>

          <input type="hidden" name="calculatedTotalPrice" id="calculatedTotalPrice" />
          <input type="hidden" name="calculatedPriceBreakdown" id="calculatedPriceBreakdown" />

          <hr style="margin:25px 0;" />

          <!-- ================= SECTION: ITEMS ================= -->
          <label>Total Items</label>
          <input type="number" id="totalItems" name="totalItems" min="1" required />

          <button type="submit" style="margin-top:20px;">Submit Update</button>

        </form>
      </div>

    </div><!-- end content -->

  </div><!-- end main -->

</div><!-- end layout -->

<script src="assets/script.js"></script>

<script>
  // Expand dropdown when typing
  const searchInput = document.querySelector("#customerRefSearch");
  const resultBox = document.querySelector("#customerSearchList");

  if (searchInput) {
    searchInput.addEventListener("focus", () => resultBox.style.display = "block");
    searchInput.addEventListener("input", () => resultBox.style.display = "block");

    document.addEventListener("click", (e) => {
      if (!resultBox.contains(e.target) && e.target !== searchInput) {
        resultBox.style.display = "none";
      }
    });
  }
</script>

</body>
</html>
